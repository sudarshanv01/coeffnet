# Coefficient Matrix 

We are interested in learning the absolute value of the coefficients of the molecular orbital, $\mathbf{C}$ (also sometimes referred to as the coefficient matrix) generated by solving the eigenvalue problem, 

$$
\mathbf{F}\mathbf{C} = \mathbf{\epsilon} \mathbf{S}\mathbf{C}
$$

where $\mathbf{F}$ is the Fock matrix, $\mathbf{S}$ is the overlap matrix and $\epsilon$ are the eigenvalues for the molecular orbitals. 

```{admonition} Code compatability
Currently we enable parsing of these quantities only for [QChem](https://www.q-chem.com/), which is an electronic structure code which operates in localized basis. Future versions of `minimal-basis` may extend the parsing of these matrices to different electronic structure codes.
```

## Converting to orthonormal basis

We will learn the coefficient matrix when all basis functions are orthogonal to each other. To convert $\mathbf{C}$ from the non-orthonormal basis in which it was computed to an orthonormal basis, we compute the orthogonalization matrix, $\mathbf{S}^{-1/2}$, 

$$
\mathbf{S}^{-1/2} = \Lambda \lambda^{-1/2} \tilde{\Lambda}
$$

where $\Lambda$ are the eigenvectors and $\lambda$ are the eigenvalues of $\mathbf{S}$ and the tilde refers to the transpose of a matrix. The orthogonal Fock matrix, $\mathbf{F}^\prime$ is generated using $\mathbf{S}^{-1/2}$, 

$$
\mathbf{F}^\prime = \tilde{\mathbf{S}}^{-1/2} \mathbf{F} \mathbf{S}^{-1/2}.
$$

Diagonalising $\mathbf{F}^\prime$ gives the coefficient matrix in orthonormal basis, $\mathbf{C}^\prime$. 

$$
\mathbf{F}^\prime \mathbf{C}^\prime = \epsilon \mathbf{C}^\prime
$$


## Converting to minimal basis 

We use the _direct projection_ method to convert the coefficient matrix from the basis in which it was computed to the minimal basis. This projection is particularly useful if a very large basis was used to perform the DFT calculation and we are interested in learning something simpler.


